<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>TP &mdash; Termites</title>
    <link rel="stylesheet" type="text/css" href="http://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="./libs/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./css/styles.css">
</head>
<body>
    <div class="container">
        <h1>TP &mdash; Termites</h1>

        <div class="controls">
            <h3>Contrôles</h3>
            <button class="btn btn-lg btn-primary" role="button">
                <span class="glyphicon glyphicon-play"></span>
            </button>
            <button class="btn btn-lg btn-warning" role="button">
                <span class="glyphicon glyphicon-pause"></span>
            </button>
            <button class="btn btn-lg btn-success" role="button">
                <span class="glyphicon glyphicon-refresh"></span>
            </button>
            <button class="btn btn-lg btn-danger" role="button">
                <span class="glyphicon glyphicon-trash"></span>
            </button>

            <div id="speedValue">Vitesse: 100%</div>
            <div id="speedSlider" style="width: 200px; margin: 20px;"></div>


            <a href="./examples/AStar.html" class="btn btn-lg btn-info" role="button">
                Voir la page du A*
            </a>
            <br><br>
            <a href="./examples/AlgorithmeGenetique.html" class="btn btn-lg btn-info" role="button">
                Voir la page de
                <br>
                l'algo. génétique
            </a>

            <br><br>

            <h3>Options</h3>
            <label class="checkbox">
                <input type="checkbox" id="umbilical" checked> Graphe des appartenances
            </label>
            <label class="checkbox">
                <input type="checkbox" id="paths" checked> Graphe des chemins
            </label>
        </div>

        <canvas id="canvas" height="600" width="600"></canvas>

        <div class="panel-group" id="accordion">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                            View article
                        </a>
                    </h4>
                </div>
                <div id="collapseOne" class="panel-collapse collapse">
                    <div class="panel-body">

                        <section class="article well well-lg">
                            <h1>Plan</h1>

                            <ul class="plan">
                                <li><a href="#intro" class="h1">Introduction</a></li>
                                <ul>
                                    <li><a href="#termite" class="h2">Termite : qu’est ce que c’est que cette petite bête ?</a></li>
                                    <li><a href="#strategie" class="h2">Notre stratégie : explications</a></li>
                                </ul>

                                <li><a href="#systemesexperts" class="h1">Décisions grâce aux systèmes experts</a></li>
                                <ul>    
                                    <li><a href="#principe" class="h2">Principe d’un système expert</a></li>
                                    <li><a href="#sestrategie" class="h2">La stratégie globale ou les différentes règles</a></li>
                                    <ul>
                                        <li><a href="#ptermite" class="h3">Phase de mise en place des termitières</a></li>
                                        <li><a href="#pselection" class="h3">Phase de sélection naturelle du nid le plus fort</a></li>
                                        <li><a href="#pagglo" class="h3">Phase d’agglomération des ressources de la carte</a></li>
                                    </ul>
                                    <li><a href="#moteur" class="h2">Le moteur d’inférence</a></li>
                                </ul>

                                <li><a href="#generation" class="h1">Génération d’un graphe à l’aide d’un algorithme génétique</a></li>
                                <ul>
                                    <li><a href="#gintro" class="h2">Introduction</a></li>
                                    <li><a href="#gprincipe" class="h2">Principe de l’algorithme génétique</a></li>
                                </ul>

                                <li><a href="#recherche" class="h1">Recheche du plus court chemin</a></li>
                                <ul>
                                    <li><a href="#astar" class="h2">Mise en place de l’algorithme de A* (A star)</a></li>
                                    <li><a href="#astarprincipe" class="h2">Principe de fonctionnement</a></li>
                                </ul>
                            </ul>

                            <h1 id="intro">Introduction</h1>

                            <h2 id="termite">Termite : qu’est ce que c’est que cette petite bête ?</h2>

                            <p>Les termites, comme les fourmis, sont des insectes sociaux. Certaines espèces de termites peuvent être eusociale, c’est-à-dire qu’il existe une cohésion de groupe et que chaque membres appartient à une caste experte dans une tâche.</p>

                            <p>Les termites n’ont pas tous le même rôle au sein d’un nid. En effet, il y cohabite plusieurs castes d’individu :</p>

                            <ul>
                                <li>les reines, qui prennent des décisions cruciales pour la termitière (pondre plus de soldats ou d’ouvriers).
                                <br>Elles peuvent même décider de quitter la termitière actuelle pour une autre.</li>
                                <li>les rois, qui sont là principalement pour se reproduire avec les reines</li>
                                <li>les soldats, qui assurent la sécurité du nid</li>
                                <li>les ouvriers, qui sont chargés des travaux d'aménagement du nid et d'approvisionnement</li>
                            </ul>

                            <h2 id="strategie">Notre stratégie : explications</h2>

                            <p>Sachant que le TP consiste à agglomérer des tas de bois, nous avons gardé deux castes de termites : les reines pour leurs capacités à prendre des décisions, et les ouvriers pour leurs capacités exécuter ces dernières.</p>

                            <p>Les décisions des termites seront prises par le biais de systèmes experts.
                            Les reines quant à elles, ont la faculté de générer un graphe afin d’orienter leurs congénères sur la carte. Les graphes de déplacements seront générés grâce à un algorithme génétique.
                            Les routes à emprunter doivent être calculées grâce à un algorithme de recherche du plus court chemin.</p>

                            <p>Ce document, sera donc découpé en trois parties :</p>

                            <ul>
                                <li>Décision grâce aux systèmes experts</li>
                                <li>Génération d’un graphe à l’aide d’un algorithme génétique</li>
                                <li>La recherche du plus court chemin dans un graphe</li>
                            </ul>

                            <!-- -------------------------------------------------------------------------------------------------------------- -->
                            
                            <h1 id="systemesexperts">Décisions grâce aux systèmes experts</h1>


                            <p>La définition du site Wikipédia est la suivante :</p>

                            <blockquote>“ D'une manière générale, un système expert est un outil capable de reproduire les mécanismes cognitifs d'un expert, dans un domaine particulier. Il s'agit de l'une des voies tentant d'aboutir à l'intelligence artificielle. ”</blockquote>

                            <p>Cette définition s’applique parfaitement à notre cas, où justement, les termites sont experts dans le domaine de leur caste.</p>

                            <h2 id="principe">Principe d’un système expert</h2>

                            <p>Un système expert se divise en trois parties :</p>

                            <ol>
                                <li>Une base de faits</li>
                                <li>Une base de règles</li>
                                <li>Un moteur d’inférence</li>
                            </ol>

                            <p>Les trois parties susmentionnées fonctionnent de concert afin de délivrer un résultat répondant à une situtation donnée.</p>
                            <p>Une règle est composée de faits et expose un autre fait, qui peut être conclusion et / ou premisse d’une autre règle. Le moteur d’inférence est donc chargé, quant à lui, d’itérer sur la base de règles en jouant avec les données “du monde réel” afin d’obtenir une conclusion finale, résultat logique de la situation représentée.</p>

                            <h2 id="sestrategie">La stratégie globale ou les différentes règles</h2>

                            <p>Toutes ses règles et stratégies peuvent facilement être gérées par un système expert. Nous avons donc décidé de mettre en oeuvre deux systèmes experts :</p>
                                
                            <ul>
                                <li>un système expert pour les reines</li>
                                <li>un système expert pour les ouvriers</li>
                            </ul>

                            <p>Notre stratégie se divise en trois phases distinctes :</p>

                            <ol>
                                <li>La mise en place des nids</li>
                                <li>La sélection naturelle du nid le plus fort</li>
                                <li>La collecte des ressources présentes sur la carte</li>
                            </ol>

                            <h3 id="ptermite">Phase de mise en place des termitières</h3>

                            <p>Au début, les termites sont tous “rōnin” (samouraï sans maître) :</p>

                            <ul>
                                <li>Un termite “rōnin” se déplace aléatoirement sur la carte</li>
                                <li>Lorsqu’un termite “rōnin” rencontre un tas de bois sans reine, il change ce tas de bois en termitière en y plaçant une nouvelle reine et se change en termite “ouvrier”. Une reine est caractérisée par sa puissance (égale à la taille du tas qu’elle dirige)</li>
                                <li>Lorsqu’un termite “rōnin” rencontre une termitière, il jure fidélité à la reine qui la dirige et devient un termite “ouvrier”</li>
                                <li>Si un termite “ouvrier” rencontre un termite “rōnin” ou un termite “ouvrier” d’une reine différente et moins puissante, celui-ci rallie ce dernier à sa cause</li>
                            </ul>

                            <p>De cette façon, plusieurs termitières (pas forcément toutes) sont misent en place et les termites “rōnin” disparaissent petit à petit au profit de termites “ouvriers”.</p>

                            <h3 id="pselection">Phase de sélection naturelle du nid le plus fort</h3>

                            <p>Afin de ne conserver que la termitière la plus forte, les termites devront mettre en place les stratégies suivantes :</p>

                            <ul>
                                <li>Si un termite “ouvrier” rencontre une termitière d’une autre reine, trois cas de figure se présentent à lui :

                                    <ul>
                                        <li>Sa reine est plus puissante (de 20 points) il va alors éliminer la reine et marquer la termitière comme “déchue” (pour que d’autre individu ne rechange plus le tas de bois en termitière). Afin que les ouvriers de la termitière “déchue” ne redeviennent pas des “rōnins” le termite laisse le phéromone de sa propre reine sur le tas de bois. Pour finir, le termite retourne auprès de sa reine pour l’informer de son régicide (ainsi que la position de la termitière “déchue”).</li>
                                        <li>Sa reine est moins puissante (de 20 points) il va alors juré fidélité à sa nouvelle reine et l’informer de la position de son ancienne reine.</li>
                                        <li>Sa reine est aussi puissante (différence inférieure à 20 points), le termite va simplement prendre un bout de bois de la termitière et retourner auprès de sa reine pour l’informer de la position de la termitière rencontrée.</li>
                                    </ul>
                                </li>

                                <li>Si un termite rencontre un tas de bois sans reine et sans phéromone, deux options s’offrent à lui :

                                    <ul>
                                        <li>Le tas de bois est plus petit (20 points) que la puissance de sa reine actuelle. Il laisse le phéromone de sa reine sur le tas de bois, le récolte et retourne auprès de sa reine en l’informant de la position du tas de bois.</li>
                                        <li>Le tas de bois est plus grand (20 points) que la puissance de sa reine actuelle. Il va alors changer le tas de bois en termitière et informer sa nouvelle reine de la position de son ancienne.</li>
                                    </ul>
                                </li>

                                <li>Si un termite rencontre un tas de bois avec un phéromone différent de celui de sa reine, il va effectuer la somme du tas de bois et de la puissance de la reine qui le collecte. En fonction de la somme, deux options s’offrent à lui :

                                    <ul>
                                        <li>La puissance de sa reine est plus petite que la somme (20 points). Il va jurer fidélité à la reine qui collecte le tas de bois et informer celle-ci de la position de son ancienne reine.</li>
                                        <li>La puissance de sa reine est plus grande que la somme (20 points). Il va écraser le phéromone par celui de sa reine, et retourne auprès de celle-ci pour lui communiquer la position de l’autre.</li>
                                    </ul>
                                </li>

                                <li>La reine doit prendre des décisions en fonctions de la nature des nouvelles informations qu’elle reçoit. S’il s'agit :

                                    <ul>
                                        <li>D’une autre termitière, elle doit envoyer ses ouvriers diminuer la taille de celle-ci afin qu’un de ses ouvriers finisse par la “condamner”.</li>
                                        <li>Un nouveau tas de bois, elle doit envoyer ses ouvriers récupérer les ressources du tas afin d’assurer la pérennité de son nid.</li>
                                    </ul>
                                </li>
                            </ul>

                            <p>De cette façon, les termites vont naturellement sélectionner la termitière la plus abondante en ressources. La dernière phase a déjà commencée.</p>

                            <h3 id="pagglo">Phase d’agglomération des ressources de la carte</h3>

                            <p>Cette phase est la plus simple:</p>

                            <ul>
                                <li>Un termite “ouvrier” sans travail va demander un travail à sa reine.</li>
                                <li>Une reine qui reçoit une demande de travail, va se charger de fournir au demandeur d’emploi une destination (correspondant à une zone à explorer ou un tas de bois à collecter).</li>
                                <li>Un termite avec un chemin en mémoire va parcourir celui-ci et :
                                    <ul>
                                        <li>si le termite rencontre un obstacle, il fait marche arrière et informe sa reine de la nature de l’obstacle (mur, termitière adverse ou tas de bois)</li>
                                        <li>si le termite arrive sur un tas de bois, il le collecte et retourne auprès de sa reine demander un nouveau travail (si le termite termine le tas de bois, il en informe la reine).</li>
                                        <li>si le termite arrive sur  la fin de son trajet et que rien ne l’attends, il découvre le terrain pendant 5 secondes (déplacements aléatoires) et retourne auprès de sa reine pour l’informer des nouvelles informations (si sa découverte du terrain a pu mettre à jour quoique ce soit) et demande un nouveau travail.</li>
                                    </ul>
                                </li>
                                <li>Une reine qui reçoit de nouvelles informations va mettre à jour son graphe de déplacement et modifier la stratégie de sa termitière.</li>
                            </ul>

                            <h2 id="moteur">Le moteur d’inférence</h2>

                            <p>Le moteur d’inférence est un outil propre à l’intelligence artificielle. Les premiers d’entre eux étaient partie entière des Systèmes Experts. Le Système Expert simple consiste en une base de connaissance, aussi appelée base de faits, et d’un moteur d’inférence. La base de connaissance contient des faits à propos du monde. Le moteur d’inférence applique des règles de logique de base sur la base de connaissance, en en déduit de nouvelles connaissances. Ce processus se répète d’autant plus que chacun des faits présent dans la base de connaissance possède la capacité de valider de nouvelles règles dans le moteur d’inférence.</p>

                            <p>Le moteur d’inférence fonctionne principalement avec deux modes :</p>

                            <ul>
                                <li>le chaînage avant</li>
                                <li>le chaînage arrière</li>
                            </ul>

                            <p>Le chaînage avant commence par les faits connus et en déduit de nouveaux faits, pouvant valider de nouvelles règles.
                            <br>
                            Le chaînage arrière commence avec les résultats, et remonte le chemin jusqu’à déterminer les faits qui doivent être validés pour atteindre l’objectif évalué.</p>

                            <!-- -------------------------------------------------------------------------------------------------------------- -->
                            
                            <h1 id="generation">Génération d’un graphe à l’aide d’un algorithme génétique</h1>

                            <h2 id="gintro">Introduction</h2>

                            <p>Avec notre stratégie pour récupérer les ressources, la reine doit être en mesure de fournir à ses ouvriers (un termite) les chemins à emprunter afin d’atteindre leurs objectifs (récupérer du bois). Pour cela, elle doit se baser sur ses connaissances du terrain (qui sont nulles au début).</p>

                            <p>L’idée principale est de construire un graphe qui permettra aux termites de se déplacer. Si un termite rencontre un obstacle sur son chemin, celui-ci fait demi-tour et informe la reine quant à la nature de l’obstacle (mur, termitière adverse ou tas de bois).
                            La reine va alors construire un nouveau graphe en tenant compte de la nouvelle information.
                            Comme les murs ainsi que les tas de bois sont placés de façon aléatoire sur la carte, nous avons décidé de mettre en place un algorithme génétique afin de générer le nouveau graphe.</p>

                            <h2 id="gprincipe">Principe de l’algorithme génétique</h2>

                            <p>Un algorithme génétique permet d’explorer un grand espace de manière efficace.
                            Il tente d’obtenir un ou plusieurs génomes permettant de fournir une solution à un problème donné. Un génome correspond à une série de données numériques ou textuelles.</p>

                            <p>L’algorithme travaille sur une population de génomes (dans notre cas, une vingtaine de génomes). Le principe consiste à évaluer toute la population pour attribuer un score à chaque individu (le score de fitness). Ce score est déterminé par la formule suivante:</p>

                            <center><strong>Fitness = (nc * 100 + A * 100) * L * C</strong></center>

                            <p>Où :</p>
                            <ul>
                                <li>nc est le nombre de chemin possible dans le graphe.</li>
                                <li>A est le ratio de la surface du graphe sur la surface totale du canvas.</li>
                                <li>L est le ratio de la moyenne des chemins sur la moyenne des distances entre chaques points du graphe.</li>
                                <li>C est le ratio du nombre de noeud accessible sur le nombre de noeuds total.</li>
                            </ul>

                            <p>La génération suivante est générée à l’aide de croisements et de mutations effectués sur les génomes ayant obtenu les meilleurs scores.</p>

                            <p>Ce processus est itéré jusqu’à l’obtention d’un résultat satisfaisant. Dans notre cas, un génome correspond une liste de sommets qui composeront le graphe.</p>

                            <h1 id="recherche">Recheche du plus court chemin</h1>

                            <h2 id="astar">Mise en place de l’algorithme de A* (A star)</h2>

                            <p>L’algorithme du A* est un algorithme de parcours de chemin permettant de déterminer le chemin le plus court entre deux points d’un graphe. Celui-ci est plus populaire que l’algorithme de Dijkstra, car plus rapide et moins gourmand en ressources.</p>

                            <p>Cependant, l’algorithme se base sur une heuristique qui doit être valide et cohérente de façon à fournir de bons résultats (dans notre cas, nous avons utilisé la distance de Manhattan).</p>

                            <p>Le principe consiste à calculer la fonction F = G + H, où:</p>
                            <ul>
                                <li>F correspond au score du noeud</li>
                                <li>G au coût de déplacement depuis le noeud de départ</li>
                                <li>H l’heuristique du noeud</li>
                            </ul>

                            <h2 id="astarprincipe">Principe de fonctionnement</h2>

                            <p>L’algorithme fonctionne en trois phases:</p>
                            <ul>
                                <li>Il Détermine toutes les heuristiques de chaque noeud du graphe, et place le noeud de départ dans une liste dite “ouverte”.</li>
                                
                                <li>Depuis la liste “ouverte” l’algorithme récupère le noeud ayant le score le plus faible. La valeur F de chacun de ses voisins est calculée, puis ceux-ci sont placés dans la liste “ouverte”. Le noeud est déplacé depuis la liste “ouverte” vers une liste dite “fermée”. L’opération se répète tant qu’il y a un noeud présent dans la liste, ou que le noeud final est atteint sans qu’aucun des noeuds de cette liste n’aient un score plus petit que le noeud courant.</li>
                                
                                <li>Si le noeud final est atteint, on remonte ses parents, ce qui donne le chemin à emprunter. Dans le cas contraire, il n’existe pas de chemin possible entre les deux points du graphe.</li>
                            </ul>
                            
                        </section>

                    </div>
                </div>
            </div>
        </div>

    </div>

    <a onclick="toTop()" class="backToTop" title="Back to top">
      <span class="glyphicon glyphicon-chevron-up"></span>
    </a>
    
    <script type="text/javascript" src="./js/expert_system/fact.js"></script>
    <script type="text/javascript" src="./js/expert_system/rule.js"></script>
    <script type="text/javascript" src="./js/expert_system/engine.js"></script>
    <script type="text/javascript" src="./js/expert_system/expert_system.js"></script>

    <script type="text/javascript" src="./js/constants.js"></script>
    <script type="text/javascript" src="./js/vector.js"></script>
    <script type="text/javascript" src="./js/world.js"></script>
    <script type="text/javascript" src="./js/agent.js"></script>
    <script type="text/javascript" src="./js/wall.js"></script>
    <script type="text/javascript" src="./js/termite_expert_system.js"></script>
    <script type="text/javascript" src="./js/pheromone.js"></script>
    <script type="text/javascript" src="./js/wood_heap.js"></script>
    <script type="text/javascript" src="./js/graph/Vertex.js"></script>
    <script type="text/javascript" src="./js/queen.js"></script>



    <script type="text/javascript" src="./js/graph/Geometry.js"></script>
    <script type="text/javascript" src="./js/graph/Vertex.js"></script>
    <script type="text/javascript" src="./js/graph/Graph.js"></script>

    <script type="text/javascript" src="./js/common/GeneticAlgorithm.js"></script>
    <script type="text/javascript" src="./js/common/QSort.js"></script>

    <script type="text/javascript" src="./js/path_finding/AStar.js"></script>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    
    <script type="text/javascript" src="./js/main.js"></script>

    <script type="text/javascript" src="./libs/bootstrap/js/bootstrap.min.js"></script>
</body>
</html>